
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>會員方案 - 付款頁</title>
    <meta name='description' content=""/>
    <meta name='keywords' content=""/>
    <meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
    <link rel="stylesheet" href="https://www.holkee.com/css/index.min.css">
    <link rel="stylesheet" href="https://www.holkee.com/css/member/member.css" type="text/css">
    <!-- <link rel="stylesheet" href="css/style.css"> -->
    <link rel="stylesheet" href="css/plans.css">

    <style type="text/css">
        .top-header-bg-w{ background-color: #fff; border-bottom: 2px solid #27d0ca;}
        .top-header-bg-w  h1.logo a{ background-image: url(https://img.holkee.com/main/logo.png); }
        .plans-wrapper .payment-contents .form-control { width: 100%; height: 50px; line-height: 50px; padding: 5px 0px; border: none; border-bottom: 1px solid #DCDCDC; border-radius: 0; }
        .plans-wrapper .payment-contents .btn-submit { min-width: 168px; line-height: 2.875rem; display: inline-block; border-radius: 50px; color: #333; font-weight: bold; border: 2px solid #333; font-size: initial; background-color: transparent; cursor: pointer; }
        .plans-wrapper .payment-contents .btn-submit:hover { background-color: #333; color: #fff; }
        .plans-wrapper .payment-contents .btn-submit:disabled { color: #666; border-color: #666; cursor: not-allowed; }
    </style>

    <!-- Magnific Popup -->
    <link rel="stylesheet" href="https://www.holkee.com/scripts/libs/magnific-popup/magnific-popup.min.css">
    <link rel="stylesheet" href="https://www.holkee.com/css/main.conflict.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script src="https://www.holkee.com/scripts/libs/magnific-popup/jquery.magnific-popup.min.js"></script>
    <script type="text/javascript">
        $(function(){
            $('.popup-link').magnificPopup({
              removalDelay: 300,
              mainClass: 'mfp-fade'
            });
        });
    </script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NKK2HTR');</script>
<!-- End Google Tag Manager -->

    
</head>
<body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKK2HTR"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <!-- header -->
    <header class="top-header top-header-bg-w">
        <nav class="Menu contents-box clearfix">
            <h1 class="logo"><a href="/">holkee</a></h1>
        </nav>
    </header>


    <!-- Premium 方案 -->
    <main class="plans-wrapper">
        <section class="plans-contents payment-contents">
             <div class="ContentsBox">
                <!-- 付款明細 -->
                <h2 class="top-title">訂單明細</h2>
                <div class="order-details">
                    <p class="j-n-items clearfix">
                        <span class="l-title">購買項目</span>
                        <span class="r-item"></span>
                    </p>
                    <p class="j-n-amount total clearfix">
                        <span class="l-title">總金額</span>
                        <span class="r-item"></span>
                    </p>
                </div>
                <!-- 付款人資料 -->
                <h2 class="top-title">付款人資料</h2>
                <p class="sub-title">holkee 將以您所填寫的個人資料作為日後交易、服務的認證依據，為維護您的權益，請務必據實填寫。<br>電子發票一經開立，如果發票有任何問題請收到發票 3 日內提出，逾期恕不受理。</p>
                <div class="payer-information">
                    <div class="payer-form">
                        <div class="top-box">
                            <h3 class="main-title">以下為開立發票所需資料，請確實填寫！</h3>
                            <p class="sub-note">*表示欄位必填</p>
                        </div>
                        <div class="fill-in-box clearfix">
                            <form id="form-purchase" class="information-info" method="post">
                                <input id="services" type="hidden" name="services">
                                <input id="platform" type="hidden" name="platform">
                                <input id="prime" type="hidden" name="prime">
                                <input id="invoice_type" type="hidden" name="invoice_type" value="1">
                                <fieldset>
                                    <input class="fill-in-text" type="text" name="payer_name" placeholder="*請填入聯絡人名稱">
                                </fieldset>
                                <fieldset>
                                    <input class="fill-in-text" type="text" name="payer_mobile" placeholder="*請填入手機號碼">
                                </fieldset>
                                <fieldset class="both clearfix">
                                    <div class="row">
                                        <input class="fill-in-text" type="text" name="payer_phone_office" placeholder="請填入辦公室電話">
                                    </div>
                                    <div class="row">
                                        <input class="fill-in-text" type="text" name="payer_phone_home" placeholder="請填入居家電話">
                                    </div>
                                </fieldset>
                                <fieldset>
                                    <input class="fill-in-text" type="text" name="payer_address" placeholder="*請填入地址">
                                </fieldset>
                                <fieldset class="both">
                                    <div class="row">
                                        <input class="fill-in-text" type="text" name="tax_id" placeholder="請填入統編(8位數字)">
                                    </div>
                                    <div class="row">
                                        <input class="fill-in-text" type="text" name="invoice_title" placeholder="請輸入發票抬頭">
                                    </div>
                                </fieldset>
                            </form>
                            <form id="form-payment" class="invoice-info">
                                <fieldset class="note-fixed-none">
                                    <legend>請選擇發票類型(*)</legend>
                                    <p>
                                      <input type="radio" id="invoice-1" value="1" onchange="document.getElementById('invoice_type').value='1';document.getElementById('invoice-2').checked=false;" checked>
                                      <label for="invoice-1">個人電子發票（二聯式）</label>
                                    </p>
                                    <p>
                                      <input type="radio" id="invoice-2" value="2" onchange="document.getElementById('invoice_type').value='2';document.getElementById('invoice-1').checked=false;">
                                      <label for="invoice-2">公司用電子發票（三聯式）</label>
                                    </p>
                                </fieldset>
                                <fieldset>
                                    <legend>請填寫信用卡資料(*)</legend>
                                    <div class="card-type">
                                        <img class="card-size" src="https://js.tappaysdk.com/tpdirect/image/visa.svg">
                                        <img class="card-size" src="https://js.tappaysdk.com/tpdirect/image/mastercard.svg">
                                        <img class="card-size" src="https://js.tappaysdk.com/tpdirect/image/jcb.svg">
                                        <img class="card-size" src="https://www.tappaysdk.com/_nuxt/img/union_pay.8271208.png">
                                    </div>
                                    <div class="form-group card-number-group">
                                        <div class="form-control card-number"></div>
                                    </div>
                                    <div class="form-group expiration-date-group">
                                        <div class="form-control expiration-date" id="tappay-expiration-date"></div>
                                    </div>
                                    <div class="form-group cvc-group">
                                        <div class="form-control cvc"></div>
                                    </div>
                                </fieldset>
                            </form>
                        </div>
                    </div>
                    <p class="sub-title"><span>按下「確認送出」</span>代表已經閱讀並且同意<a href="https://www.holkee.com/terms" target="_blank">會員條款</a>和<a href='https://www.holkee.com/privacy' target='_blank'>隱私權政策</a></p>
                    <p class="btn"><button class="btn-submit" type="submit" form="form-payment" disabled="disabled" title="本公司採用喬睿科技 TapPay SSL 2048 bit 交易系統，消費者刷卡時直接在銀行端系統中交易，本公司絕不留下您的信用卡資料，以保障您的權益。TapPay 交易系統通過 PCI - DSS 國際信用卡組織安全稽核，周全保護您的信用卡資料安全。">確認送出</button></p>
<!--
                    <p class="btn"><a class="popup-link" onclick="document.getElementById('services').value=window.location.hash;document.getElementById('platform').value='ECPAY';document.getElementById('prime').value='ECPAY';document.getElementById('form-purchase').submit();">確認送出（ECPAY）</a></p>
-->
                </div>
            </div>
        </section>
    </main>
    <footer class="footer-box">
        <div class="contents-box clearfix">
            <div class="otherbox">
                <p class="other-link">
                    <a href="https://www.holkee.com/terms" target="_blank">會員條款</a>
                    <a href="https://www.holkee.com/privacy" target="_blank">隱私權條款</a>
                    <a href="https://www.holkee.com/qa" target="_blank">教學&amp;QA</a>
                </p>
                <ul class="follow-us">
                    <li><a href="https://line.me/R/ti/p/@bca1493j" target="_blank"><i class="fab fa-line"></i></a></li>
                    <li><a href="https://www.facebook.com/holkeego/" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
                    <li><a href="https://www.holkee.com/wechat_qrcode.html" target="_blank"><i class="fab fa-weixin" aria-hidden="true"></i></a></li>
                </ul>
                <p>客服信箱：<a href="mailto:service@holkee.com" target="_blank">service@holkee.com</a><br>
                <span>（客服時間為周一至周五 9:00-18:00）</span></p>
            </div>
            <div class="l-Box">
                <p class="logo"><a href="http://www.weblisher.com.tw" target="_blank">Weblisher Taiwan Group</a></p>
                <p class="copyright">Copyrights Ⓒ 2020 All Rights Reserved.</p>
            </div>
        </div>
    </footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
<script>
    var exRate = Number('1');
    var serviceList = {
        '4cbbb6c9b8c1993f25adc601867b7917': {text: '白金月繳', price: 99 * exRate, currency: 'NT$', frequency: '30 日'},
        '5994d46e05899d30fae4d0834d0cefc9': {text: '白金年繳', price: 999 * exRate, currency: 'NT$', frequency: '365 日'},
        '793749b3f3dca5aff3a2cc740dd48663': {text: '白金三年繳', price: 2599 * exRate, currency: 'NT$', frequency: '1095 日'},
        '92fc40abc228dc1f1158ef7ea26b66e6': {text: '威旭客戶專屬白金', price: 999 * exRate, currency: 'NT$', frequency: '次'},
        '3c41b2349628e3451e8a2bbc13418c4f': {text: '白金日繳', price: 9 * exRate, currency: 'NT$', frequency: '日'},
        '8c07f3098f7de905d73c47150aa9efcd': {text: '追蹤碼安裝', price: 30 * exRate, currency: 'NT$', frequency: '月'},
        'fa57f15403eef809b750f44fcf53606e': {text: 'Google Analytics 每周定期報表寄送', price: 30 * exRate, currency: 'NT$', frequency: '月'},
        'ef52fa11e0702edfa82efde1656c8a4a': {text: '一對一專人諮詢', price: 199 * exRate, currency: 'NT$', frequency: '月'},
        'a5d0506b19a3a611cd296589caf155aa': {text: '網站圖示', price: 30 * exRate, currency: 'NT$', frequency: '月'},
        '77c9dc7152cf95d5754c69c5dd114e77': {text: '微電商網站代號變更', price: 30 * exRate, currency: 'NT$', frequency: '次'},
        'afeae76b04f552528ff761d441e202b0': {text: '自動轉址設定', price: 30 * exRate, currency: 'NT$', frequency: '月'},
        '1b8e735c38f4398b83a03cc12c1dcf2f': {text: '子網域設定', price: 99 * exRate, currency: 'NT$', frequency: '月'},
        'dccc0ae11a314ad38c3682a5d3868f1f': {text: 'Google 搜尋引擎收錄', price: 30 * exRate, currency: 'NT$', frequency: '月'},
        '55cb5045c14558090b5a6591553456e8': {text: '客服連結按鈕', price: 30 * exRate, currency: 'NT$', frequency: '月'},
        '28d9e37e2c34229cb661d59dd43c78c8': {text: '首頁促銷大看板 1 款', price: 2099 * exRate, currency: 'NT$', frequency: '次'},
        '02d2290d0c1f781231b68979e1866e3c': {text: '首頁促銷大看板 2 款', price: 3779 * exRate, currency: 'NT$', frequency: '次'},
        '7b90e8e9ea4a74a1a8864645dc81d47d': {text: '首頁促銷大看板 3 款', price: 5249 * exRate, currency: 'NT$', frequency: '次'},
        '62b6effc7484efbfb6e55d8c8b8c62b7': {text: '促銷短影音 1 支', price: 2099 * exRate, currency: 'NT$', frequency: '次'},
        'deeaa552e617fba6fe01140d6562e136': {text: '首頁促銷大看板 2 款 + 促銷短影音 1 支', price: 5249 * exRate, currency: 'NT$', frequency: '次'},
        '12fdeac748145165484bebc1f45c95a0': {text: '首頁促銷大看板 2 款 + 促銷短影音 2 支', price: 6299 * exRate, currency: 'NT$', frequency: '次'},
        'cfbaef015bcb42fb836126ab91cb0bca': {text: 'Yahoo 新聞稿', price: 9999 * exRate, currency: 'NT$', frequency: '次'},
        'd198e0a5dce92bb6ed109d9840309a84': {text: 'Google 關鍵字 30 天方案', price: 8400 * exRate, currency: 'NT$', frequency: '次'},
        '5be2c4d461d12449e300cb01d576f0e6': {text: 'Facebook 廣告貼文 30 天方案', price: 10500 * exRate, currency: 'NT$', frequency: '次'},
        'c4db3b906be96ef11c01a14e229cd484': {text: 'Yahoo 關鍵字品牌推廣 - 小資限定', price: 599 * exRate, currency: 'NT$', frequency: '月'},
        'fef93fa8deb3ee76b717f7ea20cf5acb': {text: 'Yahoo 關鍵字品牌推廣 - 達人限定', price: 999 * exRate, currency: 'NT$', frequency: '月'}
    };
    var cartName = 'CART-' + window.location.host;
    var cartList = {};
    $(function () {
        var service = window.location.hash.replace('#', '');
        var postData = [], textItems = [], textCurrency = '', textTotal = '';
        var htmlButton = '<a class="j-n-remove" title="刪除"><i class="far fa-times-circle"></i></a>';
        if (service.length == 0) service = window.location.search.replace('?', '').split('&')[0];
        if (service.length == 0) service = '5994d46e05899d30fae4d0834d0cefc9';
        if (service === 'cart') {
            cartList = JSON.parse(sessionStorage.getItem(cartName));
            if (function (obj) { for (undefined in obj) return false; return true; }(cartList)) {
                alert('未選擇任何項目');
                window.location.href = '/plans#go-additional';
                return false;
            }
            Object.keys(cartList).forEach(function (service) {
                postData.push(service);
                textItems.push(serviceList[service].text + ' ' +
                    serviceList[service].currency +
                    numeral(serviceList[service].price).format('0,0') + ' / ' +
                    serviceList[service].frequency + ' ' +
                    $(htmlButton).attr('id', service).prop('outerHTML'));
                textCurrency = serviceList[service].currency;
                textTotal = Number(textTotal) + Number(serviceList[service].price);
            });
        } else {
            if (function (obj) { for (undefined in obj) return false; return true; }(serviceList[service])) {
                alert('未選擇任何項目');
                window.location.href = '/plans';
                return false;
            }
            postData.push(service);
            textItems.push(serviceList[service].text + ' ' +
                serviceList[service].currency +
                numeral(serviceList[service].price).format('0,0') + ' / ' +
                serviceList[service].frequency  + ' ' +
                $(htmlButton).attr('id', service).prop('outerHTML'));
            textCurrency = serviceList[service].currency;
            textTotal = Number(serviceList[service].price);
        }
        $('#services').val(postData.join(','));
        $('.j-n-items').find('.r-item').html(textItems.join('<br>'));
        $('.j-n-amount').find('.r-item').html(textCurrency + numeral(textTotal).format('0,0') + '（含稅）');
        $('.j-n-remove').click(function () {
            delete cartList[$(this).attr('id')];
            sessionStorage.setItem(cartName, JSON.stringify(cartList));
            if (service !== 'cart') window.location.replace(window.location.pathname + '#empty');
            window.location.reload();
        });
        $('#form-purchase').on('input', 'input[name="payer_name"]', function () {
            if ($(this).val().length > 50) $(this).val($(this).val().slice(0, 50));
        });
        $('#form-purchase').on('input', 'input[name="payer_mobile"]', function () {
            if ($(this).val().match(/[^0-9]/i)) $(this).val($(this).val().replace(/[^0-9]/g, ''));
            if ($(this).val().length > 20) $(this).val($(this).val().slice(0, 20));
        });
        $('#form-purchase').on('input', 'input[name="payer_phone_office"]', function () {
            if ($(this).val().length > 20) $(this).val($(this).val().slice(0, 20));
        });
        $('#form-purchase').on('input', 'input[name="payer_phone_home"]', function () {
            if ($(this).val().length > 20) $(this).val($(this).val().slice(0, 20));
        });
        $('#form-purchase').on('input', 'input[name="payer_address"]', function () {
            if ($(this).val().length > 200) $(this).val($(this).val().slice(0, 200));
        });
        $('#form-purchase').on('input', 'input[name="tax_id"]', function () {
            if ($(this).val().match(/[^0-9]/i)) $(this).val($(this).val().replace(/[^0-9]/g, ''));
            if ($(this).val().length > 8) $(this).val($(this).val().slice(0, 8));
        });
        $('#form-purchase').on('input', 'input[name="invoice_title"]', function () {
            if ($(this).val().length > 200) $(this).val($(this).val().slice(0, 200));
        });
        $('#form-purchase').on('submit', function (e) {
            if ($(this).find('input[name="payer_name"]').val().length == 0) {
                alert('請填入聯絡人名稱');
                $(this).find('input[name="payer_name"]').focus();
                $('button[type="submit"]').attr('disabled', false);
                e.preventDefault();
                return;
            }
            if ($(this).find('input[name="payer_mobile"]').val().length == 0) {
                alert('請填入手機號碼');
                $(this).find('input[name="payer_mobile"]').focus();
                $('button[type="submit"]').attr('disabled', false);
                e.preventDefault();
                return;
            }
            if ($(this).find('input[name="payer_address"]').val().length == 0) {
                alert('請填入地址');
                $(this).find('input[name="payer_address"]').focus();
                $('button[type="submit"]').attr('disabled', false);
                e.preventDefault();
                return;
            }
            if ($(this).find('input[name="invoice_type"]').val() == 2) {
                if ($(this).find('input[name="tax_id"]').val().length != 8) {
                    alert('統編格式需為 8 位數字');
                    $(this).find('input[name="tax_id"]').focus();
                    $('button[type="submit"]').attr('disabled', false);
                    e.preventDefault();
                    return;
                }
                if ($(this).find('input[name="invoice_title"]').val().length == 0) {
                    alert('請填入發票抬頭');
                    $(this).find('input[name="invoice_title"]').focus();
                    $('button[type="submit"]').attr('disabled', false);
                    e.preventDefault();
                    return;
                }
            } else {
                $(this).find('input[name="tax_id"]').val('');
                $(this).find('input[name="invoice_title"]').val('');
            }
        });
    });
</script>
<script src="https://js.tappaysdk.com/tpdirect/v5.1.0"></script>
<script>
    TPDirect.setupSDK(16284, 'app_GwCILvOd5MmKuj2m1BzULpZjorLJTfqhYhd6pIjHKQvnegSo4aC6dYZF84xI', 'production')
    TPDirect.card.setup({
        fields: {
            number: {
                element: '.form-control.card-number',
                placeholder: '**** **** **** ****'
            },
            expirationDate: {
                element: document.getElementById('tappay-expiration-date'),
                placeholder: 'MM / YY'
            },
            ccv: {
                element: $('.form-control.cvc')[0],
                placeholder: '信用卡安全碼'
            }
        },
        styles: {
            'input': {
                'color': 'gray'
            },
            'input.ccv': {
                //'font-size': '16px'
            },
            ':focus': {
                'color': 'black'
            },
            '.valid': {
                'color': 'green'
            },
            '.invalid': {
                'color': 'red'
            },
            '@media screen and (max-width: 400px)': {
                'input': {
                    'color': 'orange'
                }
            }
        }
    })
    // listen for TapPay Field
    TPDirect.card.onUpdate(function (update) {
        /* Disable / enable submit button depend on update.canGetPrime  */
        /* ============================================================ */

        // update.canGetPrime === true
        //     --> you can call TPDirect.card.getPrime()
        // const submitButton = document.querySelector('button[type="submit"]')
        if (update.canGetPrime) {
            // submitButton.removeAttribute('disabled')
            $('button[type="submit"]').removeAttr('disabled')
        } else {
            // submitButton.setAttribute('disabled', true)
            $('button[type="submit"]').attr('disabled', true)
        }


        /* Change card type display when card type change */
        /* ============================================== */

        // cardTypes = ['visa', 'mastercard', ...]
        var newType = update.cardType === 'unknown' ? '' : update.cardType
        $('#cardtype').text(newType)



        /* Change form-group style when tappay field status change */
        /* ======================================================= */

        // number 欄位是錯誤的
        if (update.status.number === 2) {
            setNumberFormGroupToError('.card-number-group')
        } else if (update.status.number === 0) {
            setNumberFormGroupToSuccess('.card-number-group')
        } else {
            setNumberFormGroupToNormal('.card-number-group')
        }

        if (update.status.expiry === 2) {
            setNumberFormGroupToError('.expiration-date-group')
        } else if (update.status.expiry === 0) {
            setNumberFormGroupToSuccess('.expiration-date-group')
        } else {
            setNumberFormGroupToNormal('.expiration-date-group')
        }

        if (update.status.cvc === 2) {
            setNumberFormGroupToError('.cvc-group')
        } else if (update.status.cvc === 0) {
            setNumberFormGroupToSuccess('.cvc-group')
        } else {
            setNumberFormGroupToNormal('.cvc-group')
        }
    })

    $('#form-payment').on('submit', function (event) {
        event.preventDefault()

        // fix keyboard issue in iOS device
        forceBlurIos()

        const tappayStatus = TPDirect.card.getTappayFieldsStatus()

        // Check TPDirect.card.getTappayFieldsStatus().canGetPrime before TPDirect.card.getPrime
        if (tappayStatus.canGetPrime === false) {
            alert('Can not get prime!!')
            return
        }

        // Get prime
        TPDirect.card.getPrime(function (result) {
            if (result.status !== 0) {
                alert('Get prime error ' + result.msg)
                return
            }
            sessionStorage.removeItem(cartName)
            $('button[type="submit"]').attr('disabled', true)
            $('#platform').val('TAPPAY')
            $('#prime').val(result.card.prime)
            $('#form-purchase').submit()
        })
    })

    function setNumberFormGroupToError(selector) {
        $(selector).addClass('has-error')
        $(selector).removeClass('has-success')
    }

    function setNumberFormGroupToSuccess(selector) {
        $(selector).removeClass('has-error')
        $(selector).addClass('has-success')
    }

    function setNumberFormGroupToNormal(selector) {
        $(selector).removeClass('has-error')
        $(selector).removeClass('has-success')
    }

    function forceBlurIos() {
        if (!isIos()) {
            return
        }
        var input = document.createElement('input')
        input.setAttribute('type', 'text')
        // Insert to active element to ensure scroll lands somewhere relevant
        document.activeElement.prepend(input)
        input.focus()
        input.parentNode.removeChild(input)
    }

    function isIos() {
        return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }
</script>

</body>
</html>
